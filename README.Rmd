---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# xlsxread

<!-- badges: start -->
![R](https://img.shields.io/badge/-package-steelblue?logo=r)
[![version](https://img.shields.io/github/r-package/v/clement-LVD/xlsxread?label=Version)](https://github.com/clement-LVD/xlsxread)
[![CRAN status](https://www.r-pkg.org/badges/version/xlsxread)](https://CRAN.R-project.org/package=xlsxread)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![R build status](https://github.com/Clement-LVD/xlsxread/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/Clement-LVD/xlsxread/actions)
[![codecov](https://codecov.io/gh/Clement-LVD/xlsxread/branch/main/graph/badge.svg?token=ZTMHT15VXP)](https://codecov.io/gh/Clement-LVD/xlsxread)
<!-- badges: end -->

`xlsxread::` is an R package dedicated to import an Excel `.xlsx` sheet using `xlsxread::readxlsx()`.  

> `xlsxread::` provides a lightweight XML parser within base R.

Features:

- üöÄ *Quick reading* of `.xlsx` files
   - üåç from a URL  
   - üíæ or from a file path  
- ùÑú Import a `data.frame` within the R programming environment
   - üìÖ Types are inferred according to Excel `.xlsx` conventions, e.g., `Date`, `character`, and `numeric` values^[Note that R `data.frame` handle a single type of value within a column, i.e. a vector with several types is turned into a `character` vector]
   
## Installation

You can install the development version of `xlsxread::` from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("Clement-LVD/xlsxread")
```

## Examples

Import a datasheet from .xlsx file with `xlsxread::readxlsx()`. 

- Import from an URL :

```{r onlineexample}

datas <- xlsxread::readxlsx(url = "https://go.microsoft.com/fwlink/?LinkID=521962"
, sheet = 1, remove_first_row_as_header = TRUE)

str(datas)

student <- xlsxread::readxlsx(url = "https://www.exceldemy.com/wp-content/uploads/2023/12/Project-Management-Sample-Data.xlsx"
, skip_rows = 1:4, remove_first_row_as_header = TRUE)

str(student)

```

- Import from a local file :

```{r example2}

datas <- xlsxread::readxlsx(filepath =  "C:/me/fake_datas.xlsx", sheet = 1)


```

## Parameters
Regarding `xlsxread::readxlsx()`,

- Main parameters are :
  - `filepath` or `url` : the local path or the url of to the .xlsx file
  - `sheet` : the sheet to import (defaut to 1 for the first sheet of the .xlsx) 
- Optional parameters are :
  - `skip_rows` : first(s) row(s) to skip, e.g., `c(1,2,3)`. Default is `NULL` (don't skip rows).
  - `remove_first_row_as_header` : use the first row cells values as colnames. Default is `FALSE` (colnames will be 'A', 'B', 'C', etc.)
  - If an `url` is provided, the user have the possibility to pass (optionnal) parameters to `utils::download.file()` in order to configure the download
